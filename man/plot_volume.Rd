% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_volume.R
\name{plot_volume}
\alias{plot_volume}
\title{Plot Submission Volume with Predictions}
\usage{
plot_volume(
  data,
  show_predictions = TRUE,
  show_phe = TRUE,
  color_by_period = TRUE,
  facet_ncol = 4L,
  title = NULL,
  subtitle = NULL,
  caption = NULL
)
}
\arguments{
\item{data}{A data frame containing volume metrics with columns:
\code{fy}, \code{org}, \code{value} (count of submissions). If predictions are included,
also needs \code{prediction}, \code{low}, \code{high}, and \code{type} columns.}

\item{show_predictions}{Logical, whether to show prediction ribbon and line
(default: TRUE). Requires \code{prediction}, \code{low}, \code{high}, \code{type} columns.}

\item{show_phe}{Logical, whether to show COVID-19 Public Health Emergency
highlighting (default: TRUE).}

\item{color_by_period}{Logical, whether to color points by MDUFA period
(default: TRUE). Requires \code{report_mdufa_period} column in data.}

\item{facet_ncol}{Number of columns in facet grid (default: 4).}

\item{title}{Optional plot title. If NULL, a default title is generated.}

\item{subtitle}{Optional plot subtitle. If NULL, a default subtitle is used.}

\item{caption}{Plot caption. If NULL (default), auto-generates a caption
listing source reports with cutoff dates using
\code{\link{source_caption_with_dates}}. If FALSE or NA, no caption is
shown. If a character string, uses that value.}
}
\value{
A ggplot2 object that can be further customized with \code{+}.
}
\description{
Creates a visualization of submission volume over time with optional
linear model predictions and confidence intervals.
}
\details{
The plot displays submission volume using:
\itemize{
\item Points for each fiscal year/organization
\item Text labels showing the count value
\item Optional prediction ribbon (confidence interval) and trend line
\item Shape indicates Actual vs Predicted values when predictions are shown
}

To include predictions, prepare your data with a linear model:

\if{html}{\out{<div class="sourceCode">}}\preformatted{model <- lm(value ~ fy * org, data = data)
preds <- predict(model, newdata = data, se.fit = TRUE)
data <- data |>
  mutate(
    prediction = preds$fit,
    low = prediction - 1.96 * preds$se.fit,
    high = prediction + 1.96 * preds$se.fit,
    type = if_else(is.na(value), "Predicted", "Actual"),
    value = coalesce(value, prediction)
  )
}\if{html}{\out{</div>}}
}
\examples{
\dontrun{
# Basic volume plot without predictions
data_volume |>
  plot_volume(show_predictions = FALSE)

# Volume plot with predictions
data_volume_with_preds |>
  plot_volume(
    title = "510(k) Submission Volume",
    caption = "Source: MDUFA Performance Reports"
  )
}
}
