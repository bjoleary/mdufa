% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_otp.R
\name{plot_otp}
\alias{plot_otp}
\title{Plot On-Time Performance Metrics}
\usage{
plot_otp(
  data,
  cohort_status,
  goal_days = 90L,
  show_phe = TRUE,
  phe_label_y = 0,
  show_goal_line = FALSE,
  goal_percent = 0.9,
  fade_open_cohorts = TRUE,
  color_by_period = TRUE,
  facet_ncol = 4L,
  title = NULL,
  subtitle = NULL,
  caption = NULL
)
}
\arguments{
\item{data}{A data frame containing OTP metrics with columns:
\code{fy}, \code{org}, \code{value} (percent as decimal 0-1).}

\item{cohort_status}{A data frame with cohort closure status (required).
Must contain \code{fy}, \code{org}, \code{percent_closed}, and \code{status} columns.}

\item{goal_days}{Integer, the review goal in days (default: 90).
Used in default title generation.}

\item{show_phe}{Logical, whether to show COVID-19 Public Health Emergency
highlighting (default: TRUE).}

\item{phe_label_y}{Numeric, y-axis position for the PHE label (default: 0).}

\item{show_goal_line}{Logical, whether to show a horizontal reference line
at goal_percent (default: FALSE).}

\item{goal_percent}{Numeric, the goal percentage as decimal (default: 0.90).
Only used if show_goal_line = TRUE.}

\item{fade_open_cohorts}{Logical, whether to reduce opacity for open cohorts
(default: TRUE). When TRUE, alpha is scaled based on \code{percent_closed}
(range 0.3-1.0).}

\item{color_by_period}{Logical, whether to color points by MDUFA period
(default: TRUE). Requires \code{report_mdufa_period} column in data.}

\item{facet_ncol}{Number of columns in facet grid (default: 4).}

\item{title}{Optional plot title. If NULL, a default title is generated.}

\item{subtitle}{Optional plot subtitle. If NULL, a default subtitle is used.}

\item{caption}{Plot caption. If NULL (default), auto-generates a caption
listing source reports with cutoff dates using
\code{\link{source_caption_with_dates}}. If FALSE or NA, no caption is
shown. If a character string, uses that value.}
}
\value{
A ggplot2 object that can be further customized with \code{+}.
}
\description{
Creates a visualization of on-time performance (OTP) metrics showing
the percentage of submissions reviewed within the goal timeframe.
Points are styled by cohort status (open vs closed).
}
\details{
The plot displays on-time performance percentages using:
\itemize{
\item Points for each fiscal year/organization, with shape indicating status
\item Text labels showing the percentage value
\item Optional opacity based on cohort closure percentage
}
}
\examples{
\dontrun{
# Basic OTP plot for 510(k) program
data_otp |>
  plot_otp(
    cohort_status = cohort_status |> filter(program == "510(k)"),
    goal_days = 90L
  )

# With goal line shown
data_otp |>
  plot_otp(
    cohort_status = data_cohort_status,
    show_goal_line = TRUE,
    goal_percent = 0.90
  )
}
}
