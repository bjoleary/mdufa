% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_cycles.R
\name{plot_cycles}
\alias{plot_cycles}
\title{Plot Review Cycles Metrics}
\usage{
plot_cycles(
  data,
  cohort_status,
  show_phe = TRUE,
  phe_label_y = NA,
  fade_open_cohorts = TRUE,
  color_by_period = TRUE,
  y_limits = c(1, NA),
  label_format = c("numeric", "percent"),
  facet_ncol = 4L,
  title = NULL,
  subtitle = NULL,
  caption = NULL
)
}
\arguments{
\item{data}{A data frame containing review cycle metrics with columns:
\code{fy}, \code{org}, \code{value} (average cycles as numeric).}

\item{cohort_status}{A data frame with cohort closure status (required).
Must contain \code{fy}, \code{org}, \code{percent_closed}, and \code{status} columns.}

\item{show_phe}{Logical, whether to show COVID-19 Public Health Emergency
highlighting (default: TRUE).}

\item{phe_label_y}{Numeric, y-axis position for the PHE label.
If NA (default), uses the lower y-axis limit.}

\item{fade_open_cohorts}{Logical, whether to reduce opacity for open cohorts
(default: TRUE). When TRUE, alpha is scaled based on \code{percent_closed}
(range 0.3-1.0).}

\item{color_by_period}{Logical, whether to color points by MDUFA period
(default: TRUE). Requires \code{report_mdufa_period} column in data.}

\item{y_limits}{Numeric vector of length 2, y-axis limits
(default: c(1, NA)). Use c(1, NA) for cycles, c(0, 1) for AINN rate.}

\item{label_format}{Character, format for text labels: "numeric" (default)
shows values as decimal numbers (e.g., "1.23"), "percent" shows values
as percentages (e.g., "23\%").}

\item{facet_ncol}{Number of columns in facet grid (default: 4).}

\item{title}{Optional plot title. If NULL, a default title is generated.}

\item{subtitle}{Optional plot subtitle. If NULL, a default subtitle is used.}

\item{caption}{Plot caption. If NULL (default), auto-generates a caption
listing source reports with cutoff dates using
\code{\link{source_caption_with_dates}}. If FALSE or NA, no caption is
shown. If a character string, uses that value.}
}
\value{
A ggplot2 object that can be further customized with \code{+}.
}
\description{
Creates a visualization of average review cycles over time.
Points are styled by cohort status (open vs closed).
}
\details{
The plot displays review cycle metrics using:
\itemize{
\item Points for each fiscal year/organization, with shape indicating status
\item Text labels showing the numeric value (rounded to 2 decimal places)
\item Optional opacity based on cohort closure percentage
}

This function can also be used for AINN Rate (Additional Information
Needed rate) by transforming the data before calling:
\code{data |> mutate(value = value - 1)} and then overriding the y-axis
scale to show percentages.
}
\examples{
\dontrun{
# Basic cycles plot
data_cycles |>
  plot_cycles(
    cohort_status = cohort_status |> filter(program == "510(k)")
  )

# AINN Rate (transformed cycles, formatted as percent)
data_cycles |>
  mutate(value = value - 1) |>
  plot_cycles(
    cohort_status = cohort_status |> filter(program == "510(k)"),
    y_limits = c(0, 1),
    label_format = "percent",
    title = "Estimated rate at which 510(k)s are placed on hold"
  ) +
  labs(y = "Estimated Percent Placed On Hold")
}
}
